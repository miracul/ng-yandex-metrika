!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("ng-yandex-metrika",["exports","@angular/common","@angular/core"],t):t(e["ng-yandex-metrika"]={},e.ng.common,e.ng.core)}(this,function(e,n,r){"use strict";function u(t,s,u,a){return new(u||(u=Promise))(function(e,n){function r(e){try{i(a.next(e))}catch(t){n(t)}}function o(e){try{i(a["throw"](e))}catch(t){n(t)}}function i(t){t.done?e(t.value):new u(function(e){e(t.value)}).then(r,o)}i((a=a.apply(t,s||[])).next())})}function a(r,o){var i,s,u,e,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,s&&(u=2&e[0]?s["return"]:e[0]?s["throw"]||((u=s["return"])&&u.call(s),0):s.next)&&!(u=u.call(s,e[1])).done)return u;switch(s=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(u=0<(u=a.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){a.label=e[1];break}if(6===e[0]&&a.label<u[1]){a.label=u[1],u=e;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(e);break}u[2]&&a.ops.pop(),a.trys.pop();continue}e=o.call(r,a)}catch(t){e=[6,t],s=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var o=new r.InjectionToken("DEFAULT_COUNTER_ID_AOT"),i=new r.InjectionToken("DEFAULT_COUNTER_ID"),s=new r.InjectionToken("YANDEX_COUNTERS_CONFIGS_AOT"),c=new r.InjectionToken("YANDEX_COUNTERS_CONFIGS"),t=function I(){this.clickmap=!0,this.trackLinks=!0,this.accurateTrackBounce=!0,this.webvisor=!1,this.trackHash=!0,this.ut="noindex"},l=function(){function n(e){this.defaultCounterId=e.get(i),this.counterConfigs=e.get(c),this.positionToId=this.counterConfigs.map(function(e){return e.id})}return n.getCounterNameById=function(e){return"yaCounter"+e},n.getCounterById=function(e){return window[n.getCounterNameById(e)]},n.prototype.addFileExtension=function(t,n){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(n)];case 1:return e.sent().addFileExtension(t),[3,3];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.extLink=function(r,o,i){return void 0===o&&(o={}),u(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(i)];case 1:return t=e.sent(),n=this.getCallbackPromise(o,r),t.extLink(r,o),[2,n];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.file=function(r,o,i){return void 0===o&&(o={}),u(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(i)];case 1:return t=e.sent(),n=this.getCallbackPromise(o,r),t.file(r,o),[2,n];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.getClientID=function(e){var t=this.getCounterByPosition(e);if(t&&t.reachGoal)return t.getClientID();console.warn("Counter is still loading")},n.prototype.setUserID=function(t,n){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(n)];case 1:return e.sent().setUserID(t),[2,{userId:t,counterPosition:n}];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.userParams=function(t,n){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(n)];case 1:return e.sent().userParams(t),[2,{params:t,counterPosition:n}];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.params=function(t,n){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(n)];case 1:return e.sent().userParams(t),[2,{params:t,counterPosition:n}];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.replacePhones=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(t)];case 1:return e.sent().replacePhones(),[2,{counterPosition:t}];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.notBounce=function(r,o){return void 0===r&&(r={}),u(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(o)];case 1:return t=e.sent(),n=this.getCallbackPromise(r,r),t.notBounce(r),[2,n];case 2:return e.sent(),console.warn("Counter is still loading"),[3,3];case 3:return[2]}})})},n.prototype.fireEvent=function(o,i,s){return void 0===i&&(i={}),u(this,void 0,void 0,function(){var t,n,r;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(s)];case 1:return t=e.sent(),n=this.getCallbackPromise(i,i),t.reachGoal(o,i.params,i.callback,i.ctx),[2,n];case 2:return r=e.sent(),console.error("error",r),console.warn("'Event with type ["+o+"] can't be fired because counter is still loading'"),[3,3];case 3:return[2]}})})},n.prototype.hit=function(r,o,i){return void 0===o&&(o={}),u(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.counterIsLoaded(i)];case 1:return t=e.sent(),n=this.getCallbackPromise(o,o),t.hit(r,o),[2,n];case 2:return e.sent(),console.warn("'Hit for page ["+r+"] can't be fired because counter is still loading'"),[3,3];case 3:return[2]}})})},n.prototype.getCallbackPromise=function(r,o){return new Promise(function(e,t){var n=r.callback;r.callback=function(){n&&n.call(this),e(o)}})},n.prototype.counterIsLoaded=function(e){var t=this.getCounterByPosition(e);return t&&t.reachGoal?Promise.resolve(t):Promise.reject(t)},n.prototype.getCounterByPosition=function(e){var t=this.getCounterIdByPosition(e);return n.getCounterById(t)},n.prototype.getCounterIdByPosition=function(e){return e===undefined?this.defaultCounterId:this.positionToId[e]},n.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],n.ctorParameters=function(){return[{type:r.Injector}]},n.ngInjectableDef=r.defineInjectable({factory:function(){return new n(r.inject(r.INJECTOR))},token:n,providedIn:"root"}),n}();function d(e,t){return f(e,t)}function f(e,t){var n,r;if(n=e instanceof Array?e:[e],r=t?"number"==typeof t&&t<n.length?n[t].id:t:n[0].id){for(var o,i=!1,s=0;s<n.length;s++)(o=n[s]).id?o.id===r&&(i=!0):console.warn("You should provide counter id to use Yandex metrika counter",o);return i||console.warn("You provided wrong counter id as a default:",t),r}console.warn("You provided wrong counter id as a default:",t)}function p(e){return h(e)}function h(e){return(e instanceof Array?e:[e]).map(function(e){return Object.assign(new t,e)})}function y(e,t){return n.isPlatformBrowser(t)?(e.forEach(function(e){e.lazyConfigModifier!==undefined&&e.lazyConfigModifier(e)}),v.bind(null,e)):function(){return"none"}}function v(u){var e="yandex_metrika_callbacks2";window[e]=window[e]||[],window[e].push(function(){var e,t;try{try{for(var n=function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(u),r=n.next();!r.done;r=n.next()){g(r.value)}}catch(i){e={error:i}}finally{try{r&&!r.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}}catch(s){}});var t=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0;var r=u.find(function(e){return e.alternative});n.src=r?"https://cdn.jsdelivr.net/npm/yandex-metrica-watch/tag.js":"https://mc.yandex.ru/metrika/tag.js";var o=function(){return t.parentNode.insertBefore(n,t)};return"[object Opera]"===window.opera?document.addEventListener("DOMContentLoaded",o,!1):o(),e}function g(e){window[w(e.id)]=new Ya.Metrika2(e)}function w(e){return"yaCounter"+e}var m=function(){function n(){}return n.forRoot=function(e,t){return{ngModule:n,providers:[{provide:o,useValue:t},{provide:s,useValue:e},{provide:i,useFactory:d,deps:[s,o]},{provide:c,useFactory:p,deps:[s]},{provide:r.APP_INITIALIZER,useFactory:y,deps:[c,r.PLATFORM_ID],multi:!0},{provide:l,useClass:l,deps:[r.Injector,r.PLATFORM_ID]}]}},n.decorators=[{type:r.NgModule,args:[{}]}],n}();e.Metrika=l,e.defaultCounterIdFactory=d,e.defineDefaultId=f,e.countersFactory=p,e.createConfigs=h,e.appInitializerFactory=y,e.insertMetrika=v,e.createCounter=g,e.getCounterNameById=w,e.MetrikaModule=m,e.ɵb=i,e.ɵa=o,e.ɵd=c,e.ɵc=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng-yandex-metrika.umd.min.js.map